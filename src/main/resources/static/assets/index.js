import{r as c,c as v,R as D}from"./react.js";import{C as V,a as W,i as q,b as G,c as H,f as B}from"./fullcalendar.js";import{S as J,B as C,D as K,R as Y,a as Q,b as X,M as k,F as R,I as O,c as Z,d as P,P as A,e as ee,U as te,f as se,s as I}from"./antd.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var M={exports:{}},b={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ne=c,re=Symbol.for("react.element"),oe=Symbol.for("react.fragment"),ie=Object.prototype.hasOwnProperty,ae=ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ce={key:!0,ref:!0,__self:!0,__source:!0};function _(t,s,r){var o,n={},i=null,l=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(l=s.ref);for(o in s)ie.call(s,o)&&!ce.hasOwnProperty(o)&&(n[o]=s[o]);if(t&&t.defaultProps)for(o in s=t.defaultProps,s)n[o]===void 0&&(n[o]=s[o]);return{$$typeof:re,type:t,key:i,ref:l,props:n,_owner:ae.current}}b.Fragment=oe;b.jsx=_;b.jsxs=_;M.exports=b;var e=M.exports,U,T=v;U=T.createRoot,T.hydrateRoot;const le=parseInt(String(D.version).split(".")[0]),de=le<18;class F extends c.Component{constructor(){super(...arguments),this.elRef=c.createRef(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const s=[];for(const r of this.state.customRenderingMap.values())s.push(D.createElement(ue,{key:r.id,customRendering:r}));return D.createElement("div",{ref:this.elRef},s)}componentDidMount(){this.isUnmounting=!1;const s=new V;this.handleCustomRendering=s.handle.bind(s),this.calendar=new W(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{v.flushSync(()=>{})});let r;s.subscribe(o=>{const n=Date.now(),i=!r;(de||i||this.isUpdating||this.isUnmounting||n-r<100?$:v.flushSync)(()=>{this.setState({customRenderingMap:o},()=>{r=n,i?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){this.resizeId!==void 0&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}F.act=$;class ue extends c.PureComponent{render(){const{customRendering:s}=this.props,{generatorMeta:r}=s,o=typeof r=="function"?r(s.renderProps):r;return v.createPortal(o,s.containerEl)}}function $(t){t()}const S="";async function he(t,s){const{startStr:r,endStr:o}=t,n=new URLSearchParams({startStr:r,endStr:o,teachers:s.join(",")}).toString();return await fetch(`${S}/data?${n}`).then(i=>i.json()).then(i=>{let l=i.data;return l.forEach(d=>{d.title=d.courseName;let m=new Date(Number(d.courseDate));d.start=m.toISOString(),d.end=m.toISOString(),d.allDay=!0}),l}).catch(i=>(console.error("Error:",i),[]))}async function me(){return await fetch(`${S}/teacher`).then(t=>t.json()).then(t=>t.data).catch(t=>console.error("Error:",t))}async function fe(){return await fetch(`${S}/classroom`).then(t=>t.json()).then(t=>t.data).catch(t=>console.error("Error:",t))}async function pe(t){return await fetch(`${S}/classroom`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>s.data).catch(s=>console.error("Error:",s))}async function xe(t){return await fetch(`${S}/classroom/${t}`,{method:"DELETE"}).then(s=>s.json()).then(s=>s.data).catch(s=>console.error("Error:",s))}const L=c.createContext(void 0),ge=({children:t})=>{const[s,r]=c.useState(window.innerWidth),[o,n]=c.useState(window.innerHeight),i=()=>{r(window.innerWidth),n(window.innerHeight)};return c.useLayoutEffect(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[]),e.jsx(L.Provider,{value:{width:s,height:o},children:t})},z=()=>c.useContext(L),ye=[{label:"month",value:"dayGridMonth"},{label:"week",value:"timeGridWeek"},{label:"day",value:"timeGridDay"}],je=({calendarApi:t,setTeachers:s})=>{const[r,o]=c.useState("dayGridMonth"),[n,i]=c.useState(!0),[l,d]=c.useState([]),m=z();if(!m)return null;const{width:y}=m;c.useEffect(()=>{(async()=>{const h=(await me()).map(u=>({label:u,value:u}));d(h)})()},[]);const p=f=>{let a=f.toDate();t.gotoDate(a)},j=({target:{value:f}})=>{t.changeView(f),o(f)},w=()=>{i(!n),t.setOption("weekends",!n)},x=f=>{s(f)};return c.useEffect(()=>{t&&t.gotoDate(new Date(2023,2,1))},[t]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 0px"},children:[e.jsx("span",{style:{marginRight:"10px",minWidth:"120px"},children:"Select lecturers:"}),e.jsx(J,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select lecturers",onChange:x,options:l})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:y>1200?"row":"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(C,{type:"primary",onClick:()=>t==null?void 0:t.today(),children:"Today"}),e.jsx(K,{onChange:p})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(C,{type:"primary",shape:"circle",icon:e.jsx(Y,{}),onClick:()=>t==null?void 0:t.prev()}),e.jsx("h1",{style:{minWidth:"300px",textAlign:"center"},children:t==null?void 0:t.view.title}),e.jsx(C,{type:"primary",shape:"circle",icon:e.jsx(Q,{}),onClick:()=>t==null?void 0:t.next()})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",margin:"12px 0px"},children:[e.jsx(C,{type:n?"primary":"default",onClick:w,children:"weekends"}),e.jsx(X.Group,{options:ye,optionType:"button",buttonStyle:"solid",onChange:j,value:r})]})]})]})},we=c.memo(({selectedEvent:t,handleCloseDetails:s})=>{const{title:r,extendedProps:o,start:n}=t||{},{practiceArea:i,courseCode:l,duration:d,software:m,cohort:y,run:p,classroom:j,teacher1:w,teacher2:x,teacher3:f,manager:a,cert:h}=o||{},u=(g,E)=>e.jsxs("p",{children:[e.jsxs("strong",{children:[g,":"]})," ",E]},g);return e.jsxs(k,{width:400,footer:null,title:null,open:t!=null,onOk:s,onCancel:s,children:[e.jsx("h2",{children:r}),u("Practice Area",i),u("Course Code",l),u("Duration (Days)",d),u("Software",m),u("Cohort",y),u("Run #",p),u("Start",n?new Date(n).toLocaleString():""),u("Classroom",j),u("Teacher 1",w),u("Teacher 2",x),u("Teacher 3",f),u("Manager",a),u("Grad Cert (MTech)",h)]})}),Ce=()=>{const t=c.useRef(null),[s,r]=c.useState(null),[o,n]=c.useState([]),[i,l]=c.useState([]),[d,m]=c.useState(null);c.useEffect(()=>{var h;let a=(h=t.current)==null?void 0:h.getApi();a&&(r(a),n(a.getEvents()))},[]);const y=z();if(!y)return null;const{width:p}=y,j=a=>{m(a.event)},w=()=>{m(null)},x=a=>{const h=a.event.title,u=a.event.extendedProps,g=Se(h),E=p>1320?"18px":p>660?"14px":"10px",N=p>1320?"14px":p>660?"10px":"8px";return e.jsxs("div",{style:{padding:"4px 8px",backgroundColor:g,cursor:"pointer"},children:[e.jsx("i",{style:{fontSize:E,color:"#111",fontWeight:"bold"},children:h}),e.jsxs("div",{style:{fontSize:N,color:"#333",display:"flex",justifyContent:"space-between"},children:[e.jsx("i",{children:u.classroom}),e.jsx("br",{}),e.jsx("i",{children:u.teacher1})]})]})},f=c.useCallback(async(a,h,u)=>{try{let g=await he(a,i);n(g),h(g)}catch(g){u(g)}},[i]);return e.jsxs("div",{children:[e.jsx(je,{calendarApi:s,setTeachers:l}),e.jsx("div",{children:e.jsx(F,{ref:t,plugins:[q,G,H],headerToolbar:!1,initialView:"dayGridMonth",selectMirror:!0,dayMaxEvents:!0,events:f,eventContent:x,eventClick:j,slotMinTime:"08:00:00",slotMaxTime:"20:00:00",slotDuration:"01:00:00",contentHeight:1500})}),e.jsx(we,{selectedEvent:d,handleCloseDetails:w}),e.jsx(Re,{events:o})]})};function Se(t){let s=0;for(let o=0;o<t.length;o++)s=t.charCodeAt(o)+((s<<5)-s);let r="#";for(let o=0;o<3;o++){const n=s>>o*8&255;r+=("00"+n.toString(16)).substr(-2)}return r}const Re=({events:t})=>{function s(r){return e.jsxs("li",{children:[e.jsx("b",{children:B(r.start,{year:"numeric",month:"short",day:"numeric"})}),e.jsx("i",{children:r.title})]},r.id)}return e.jsxs("div",{children:[e.jsxs("h2",{children:["All Events (",t.length,")"]}),e.jsx("ul",{children:t.map(s)})]})},ve=c.forwardRef((t,s)=>{const[r]=R.useForm(),[o,n]=c.useState([]),[i,l]=c.useState(!1),[d,m]=c.useState(null);c.useImperativeHandle(s,()=>({add:j}));const y=a=>{m(a),l(!0)},p=async a=>{d&&d.id&&(a.id=d.id),await pe(a),await x(),l(!1),m(null)},j=()=>{m(null),l(!0)},w=async a=>{await xe(a),await x()},x=async()=>{let a=await fe();n(a)};c.useEffect(()=>{x()},[]),c.useEffect(()=>{d?r.setFieldsValue(d):r.resetFields()},[d,r]);const f=[{title:"Classroom",dataIndex:"name",key:"name",sorter:(a,h)=>a.name.localeCompare(h.name)},{title:"Size",dataIndex:"size",key:"size",sorter:(a,h)=>a.size-h.size},{title:"Software",dataIndex:"software",key:"software",render:a=>a||"N/A"},{title:"Action",key:"action",width:100,render:(a,h)=>e.jsxs(P,{size:"middle",children:[e.jsx("a",{onClick:()=>y(h),children:"Edit"}),e.jsx(A,{title:"Sure to delete?",onConfirm:()=>w(h.id),children:e.jsx("a",{children:"Delete"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:d?"Edit Classroom":"Create a new classroom",okText:d?"Save":"Create",open:i,onCancel:()=>l(!1),onOk:()=>r.submit(),destroyOnClose:!0,children:e.jsxs(R,{layout:"vertical",form:r,name:"form_in_modal",initialValues:{modifier:"public"},onFinish:p,children:[e.jsx(R.Item,{name:"name",label:"Classroom",rules:[{required:!0,message:"Please input the classroom name!"}],children:e.jsx(O,{})}),e.jsx(R.Item,{name:"size",label:"Size",rules:[{required:!0,message:"Please input the size!"}],children:e.jsx(O,{type:"number"})}),e.jsx(R.Item,{name:"software",label:"Software",children:e.jsx(O,{})})]})}),e.jsx(Z,{columns:f,dataSource:o,rowKey:"id",pagination:{pageSize:10}})]})}),be=()=>{const t={accept:".xlsx",action:`${S}/upload`,name:"file",async onChange(s){s.file.status==="done"?I.success(`${s.file.name} file uploaded successfully`):s.file.status==="error"&&I.error(`${s.file.name} file upload failed.`)}};return e.jsx(te,{...t,children:e.jsx(C,{icon:e.jsx(se,{}),children:"Click to Upload Course"})})},Ee=()=>{const[t,s]=c.useState(!1),r=c.useRef(null),o=()=>{r.current&&r.current.add()},n=()=>{s(!0)},i=()=>{s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(C,{type:"primary",onClick:n,children:"Input Course Data"}),e.jsxs(ee,{title:"Input Course Data",onClose:i,open:t,size:"large",children:[e.jsxs(P,{style:{width:"100%"},children:[e.jsx(be,{})," ",e.jsx(C,{onClick:o,type:"primary",style:{marginBottom:16},children:"Add a row"})]}),e.jsx(ve,{ref:r})]})]})},Oe=()=>{const t=z();return t?e.jsxs("div",{style:{padding:t.width>660?"0px 24px":"0"},children:[e.jsx("h1",{children:"AI-based Scheduling System"}),e.jsx(Ee,{}),e.jsx(Ce,{})]}):null};U(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(ge,{children:e.jsx(Oe,{})})}));
